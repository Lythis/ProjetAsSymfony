{% extends 'base.html.twig' %}

{% block title %}Vous êtes connecté!{% endblock %}

{% block body %}
<div class="container">
    <div class="row justify_content_center">
        <div class="col-12">
            {% if app.user %}
                <h2 class="text-center">Bonjour, {{ app.user.email }} ! Voici les derniers évenements postés.</h2>
                {% for event in events %}
                    {% set numberPlaceRemaining = event.numberPlace - event.subscriptionEvents|length %}
                    {# {% set injuredCount = random(0, event.numberPlace) %}
                    {% set deathCount = random(0, event.numberPlace) %}
                    {% set deathCountHalf = random(0, event.numberPlace / 2) %} #}
                    <div class="row my-2 justify-content-center">
                        <div class="col-10 bg-light card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-2 col-12 d-flex justify-content-center">
                                        <img src="/thumbnail/{{ event.thumbnail }}" class="rounded" style="height: 125px; width:125px;">
                                    </div>
                                    <div class="col-lg-8 col-12">
                                        <h2 class="mb-0">{{ event.name }}</h2>
                                        <span class="fs-6 text-muted">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar3" viewBox="0 0 16 16">
                                                <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z"/>
                                                <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                                            </svg>
                                            {{ event.date|date('d/m/Y') }} - {{ event.dateEnd|date('d/m/Y') }} |
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                                                <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                                <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                                                <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
                                            </svg>
                                            {{ event.numberPlace }} {% if event.numberPlace > 1 %}places{% else %}place{% endif %} - {{ numberPlaceRemaining }} {% if numberPlaceRemaining > 1 %}disponibles{% else %}disponible{% endif %}
                                            {# {% if event.sport.id is defined and event.sport.id is not null and event.sport.label == "Hockey sous glace" %} |
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-x-fill" viewBox="0 0 16 16">
                                                    <path fill-rule="evenodd" d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm6.146-2.854a.5.5 0 0 1 .708 0L14 6.293l1.146-1.147a.5.5 0 0 1 .708.708L14.707 7l1.147 1.146a.5.5 0 0 1-.708.708L14 7.707l-1.146 1.147a.5.5 0 0 1-.708-.708L13.293 7l-1.147-1.146a.5.5 0 0 1 0-.708z"/>
                                                </svg>
                                                {{ deathCount }} {% if deathCount > 1 %}Morts{% else %}Mort{% endif %}
                                            {% elseif event.sport.id is defined and event.sport.id is not null and event.sport.label == "Hockey subaquatique" %} |
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-x-fill" viewBox="0 0 16 16">
                                                    <path fill-rule="evenodd" d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm6.146-2.854a.5.5 0 0 1 .708 0L14 6.293l1.146-1.147a.5.5 0 0 1 .708.708L14.707 7l1.147 1.146a.5.5 0 0 1-.708.708L14 7.707l-1.146 1.147a.5.5 0 0 1-.708-.708L13.293 7l-1.147-1.146a.5.5 0 0 1 0-.708z"/>
                                                </svg>
                                                {{ deathCountHalf }} {% if deathCountHalf > 1 %}Morts{% else %}Mort{% endif %}
                                            {% elseif event.sport.id is defined and event.sport.id is not null and event.sport.label == "Chessboxing" %} |
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart-half" viewBox="0 0 16 16">
                                                    <path d="M8 2.748v11.047c3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                                                </svg>
                                                {{ injuredCount }} {% if injuredCount > 1 %}Blessés{% else %}Blessé{% endif %}
                                            {% endif %} #}
                                        </span>
                                        <p class="mt-2 text-break">{{ event.description }}</p>
                                    </div>
                                    <div class="col-lg-2 col-12" style="display:grid; place-items: center;">
                                        <a class="btn btn-primary w-100" href="{{ path('event_details', {'id':event.id})}}">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-zoom-in" viewBox="0 0 16 16">
                                                <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>
                                                <path d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"/>
                                                <path fill-rule="evenodd" d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z"/>
                                            </svg>
                                            Détails
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <h1>Inscrivez-vous pour accéder aux évenements!</h1>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}